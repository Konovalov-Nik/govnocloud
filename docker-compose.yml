version: '3'
services:
  node:
    image: loqutus/govnocloud-node
    ports:
      - "6969:6969"
    environment:
      "NODE_LIBVIRT_SOCKET" : "qemu+unix:///system?socket=/run/libvirt/libvirt-sock"
      "NODE_NAME": "node"
      "NODE_IP": "node"
    volumes:
      - /run/libvirt:/run/libvirt/
  etcd:
    image: quay.io/coreos/etcd:v3.2.4
    ports:
      - "2379:2379"
      - "2380:2380"
    environment:
      ETCD_LISTEN_CLIENT_URLS: http://0.0.0.0:2379
      ETCD_ADVERTISE_CLIENT_URLS: http://0.0.0.0:2379
      
  master:
    image: loqutus/govnocloud-master
    ports:
      - "7070:7070"
    environment:
      "MASTER_ETCD_HOST": "etcd"
      "MASTER_NODES": "node:node:6969"
  web:
    image: loqutus/govnocloud-web
    ports:
      - "8080:8080"
    environment:
      "WEB_MASTER_HOST": "master"
